<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Tài khoản của tôi</title>
    <th:block th:include="user/common/header_tag_common"/>
    <!-- custom css  -->
    <link rel="stylesheet" th:href="@{/css/custom2.css}">
    <link rel="stylesheet" th:href="@{/css/style-alert.css}"/>
    <link rel="stylesheet" th:href="@{/css/modal-alert.css}">
</head>
<body class="js">
<!-- Header -->
<th:block th:include="user/common/header"/>
<!--/ End Header -->

<!-- Breadcrumbs -->
<div class="breadcrumbs">
    <div class="container">
        <div class="row">
            <div class="col-12">
                <div class="bread-inner">
                    <ul class="bread-list">
                        <li><a th:href="@{/}">Trang chủ<i class="ti-arrow-right"></i></a></li>
                        <li class="active">Thông tin tài khoản</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- End Breadcrumbs -->

<!-- Product Style -->
<section class="product-area shop-sidebar shop section" style="padding-top: 15px;">
    <div class="container">
        <div class="row">

            <!-- Start account items manager Area -->
            <th:block th:include="user/common/left-navbar-manager"/>
            <!-- /End account items manager Area -->

            <div class="Account__StyledAccountLayoutInner" id="customer_edit" style="display: none;">
                <div class="heading">Thông tin tài khoản</div><br/>
                <div class="inner div-form">
                    <form id="user_info">
                        <div class="div-form-control">
                            <label class="input-label">Họ tên</label>
                            <input class="form-control" type="text" name="fullName" maxlength="128">
                        </div>
                        <div class="div-form-control ">
                            <label class="input-label">Số điện thoại</label>
                            <input class="form-control" type="tel" name="phoneNumber"
                                   placeholder="Hãy nhập SĐT để trải nghiệm tốt hơn">
                        </div>
                        <div class="div-form-control">
                            <label class="input-label">Email</label>
                            <input class="form-control" type="email" name="email" disabled="">
                        </div>
                        <div class="div-form-control">
                            <label class="input-label">Giới tính</label>
                            <label class="Radio__StyledRadio">
                                <input type="radio" name="gender" value="male" checked>
                                <span class="radio-fake"></span>
                                <span class="label">Nam</span>
                            </label>
                            <label class="Radio__StyledRadio">
                                <input type="radio" name="gender" value="female">
                                <span class="radio-fake"></span><span class="label">Nữ</span>
                            </label>
                        </div>
                        <div class="div-form-control">
                            <label class="input-label">Ngày sinh<span>(không bắt buộc)</span></label>
                            <input class="form-control" type="date" name="birthday">
                        </div>
                        <div class="div-form-control">
                            <label class="input-label">&nbsp;</label>
                            <label class="Checkbox__StyledCheckbox" style="display: flex">
                                <input name="edit_password" type="checkbox">
                                <span class="label">Thay đổi mật khẩu</span>
                            </label>
                        </div>
                        <div id="input_group_password" style="display: none;">
                            <div class="div-form-control">
                                <label class="input-label">Mật khẩu cũ</label>
                                <div>
                                    <input class="form-control" type="password" required="true" name="oldPassword"
                                           placeholder="Nhập mật khẩu cũ" value="">
                                </div>
                            </div>
                            <div class="div-form-control">
                                <label class="input-label">Mật khẩu mới</label>
                                <div>
                                    <input class="form-control" type="password" required="true" name="password"
                                           placeholder="Mật khẩu từ 6 đến 32 ký tự" value="">
                                </div>
                            </div>
                            <div class="div-form-control">
                                <label class="input-label">Nhập lại</label>
                                <div>
                                    <input class="form-control" type="password" required="true" name="passwordConfirm"
                                           placeholder="Nhập lại mật khẩu mới" value="">
                                </div>
                            </div>
                        </div>
                        <div class="div-form-control">
                            <label class="input-label">&nbsp;</label>
                            <button id="button_submit_info" type="button" class="btn btn-submit">Cập nhật</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</section>
<!--/ End Product Style 1  -->

<!-- Start Footer Area -->
<th:block th:include="user/common/footer"/>
<!-- /End Footer Area -->

<!-- The Modal -->
<div id="myModal" class="myModal">
    <!-- Modal content -->
    <div class="modal-content">
        <span class="closeModal">&times;</span>
        <img src="/images/check-success-icon.png">
        <p></p>
    </div>
</div>

<script th:inline="javascript">
    /*<![CDATA[*/
    // A $( document ).ready() block.
    $(document).ready(function () {
        getInfoAccount();
        actionForModal();

        $(".Account__StyledSideBar").siblings().css('display', 'none');
        let pageURL = $(location).attr("href");
        if (pageURL.includes("/customer/account/info")) {
            getInfoAccount();
            $("#customer_edit").css('display', 'block');
        }

        if (pageURL.includes("/customer/notification")) {
            $("#customer_notification").css('display', 'block');
        }

        /* show hide block to edit password*/
        $("input[name='edit_password']").on("click", function () {
            if ($("input[name='edit_password']").is(':checked')) {
                $("#input_group_password").show();
            } else {
                $("#input_group_password").hide();
            }
        });

        /* edit password function*/
        $("#button_submit_info").on("click", function () {
            let data = {
                "email": $("input[name='email']").val(),
                "fullName": $("input[name='fullName']").val(),
                "gender": $("input[name='gender']").val(),
                "phone": $("input[name='phoneNumber']").val(),
                "birthday": $("input[name='birthday']").val()
            }
            $("div").removeClass("has-error");
            $(".error-message").remove();

            if ($("input[name='edit_password']").is(':checked')) {
                if (validatePassword() === true) {
                    data["password"] = $("input[name='password']").val();
                    updateInfoAccount(data);
                }
                alert(data["password"]);
            } else {
                updateInfoAccount(data);
            }
        });
        /* end edit password function*/

        $(".Account__StyledNav > li > a").on('click', function () {
            $(this).addClass('is-active');
        });

        $(".Account__StyledNav > li").on('click', function () {
            $(this).addClass("is-active");
        });

        $(document).on('click', '.my-reviews__button', function (e) {
            e.preventDefault();
            $(".write-review__product img").attr("src", $(this).siblings(".my-reviews__info").find("img").attr("src"));
            $(".write-review__product-name").text($(this).siblings(".my-reviews__info").find(".my-reviews__name").text());
            $("input[name='orderItem-id']").val($(this).siblings(".my-reviews__info").attr("orderItem-id"));
            $("input[name='product-id']").val($(this).siblings(".my-reviews__info").attr("product-id"));
        });


    });





    /*]]>*/
</script>
</body>
</html>